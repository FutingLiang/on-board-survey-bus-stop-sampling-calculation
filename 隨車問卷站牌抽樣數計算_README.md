# 隨車問卷站牌抽樣數計算系統

## 系統概述

隨車問卷站牌抽樣數計算系統是一個基於網頁的工具，專為公車班次分析和抽樣計算設計。此系統可以幫助使用者根據Excel檔案中的公車班次數據，自動計算隨車抽樣數、問卷抽樣數、平假日分配以及站牌抽查數，提高工作效率和準確性。

## 主要功能

- **Excel資料匯入**：支援.xlsx和.xls格式的Excel檔案匯入
- **班次數據分析**：自動計算平均班次數和班次比例
- **隨車抽樣計算**：根據班次數據計算隨車抽樣數（20%並無條件進位）
- **問卷抽樣計算**：根據班次比例計算問卷抽樣數（2500 * 班次比例）
- **平假日分配**：當問卷抽樣數大於30時，自動分配平日和假日的問卷數量
- **站牌抽查計算**：根據站牌數計算抽查站牌數（10%並四捨五入）
- **特殊公車處理**：對幸福巴士和免費公車的特殊處理（隨車抽樣數為0）
- **市區公車處理**：確保市區公車的問卷抽樣數最低為5
- **資料篩選**：支援路線編號和客運業者的搜尋和篩選
- **資料匯出**：將分析結果匯出為Excel檔案

## 使用方法

### 1. 匯入資料

- 點擊或拖曳Excel檔案到上傳區域
- 系統支援.xlsx和.xls格式的Excel檔案
- Excel檔案需包含以下欄位：
  - 路線編號
  - 客運業者
  - 平日班次
  - 假日班次
  - 公車類別（選填）
  - 站牌數（選填）

### 2. 查看分析結果

匯入資料後，系統會自動計算並顯示以下資訊：
- 路線編號和客運業者
- 平日班次和假日班次
- 平均班次數和班次比例
- 隨車抽樣數和問卷抽樣數
- 平假日分配情況
- 站牌數和抽查站牌數

### 3. 篩選和搜尋

- 使用搜尋框輸入路線編號或關鍵字進行搜尋
- 使用客運業者下拉選單進行篩選
- 點擊「重置」按鈕清除所有篩選條件

### 4. 匯出結果

- 點擊「匯出Excel」按鈕將分析結果匯出為Excel檔案
- 匯出的檔案包含所有計算結果和分析數據

## 計算規則

### 隨車抽樣數計算
- 基本規則：平均班次數 × 20%（無條件進位）
- 特殊規則：幸福巴士和免費公車的隨車抽樣數為0

### 問卷抽樣數計算
- 基本規則：2500 × 班次比例（四捨五入）
- 特殊規則：市區公車的問卷抽樣數最低為5

### 平假日分配計算
- 當問卷抽樣數 > 30時：
  - 平日問卷數 = 問卷抽樣數 × 平日班次比例（四捨五入）
  - 假日問卷數 = 問卷抽樣數 - 平日問卷數
- 當問卷抽樣數 ≤ 30時：不分平假日

### 站牌抽查數計算
- 抽查站牌數 = 站牌數 × 10%（四捨五入）

## 系統需求

- 現代網頁瀏覽器（Chrome、Firefox、Edge等）
- 支援JavaScript
- 網路連線（用於載入必要的CDN資源）

## 技術說明

- 前端技術：HTML5, CSS3, JavaScript
- 資料處理：使用JavaScript進行客戶端計算
- 檔案處理：使用SheetJS (XLSX) 處理Excel檔案
- 介面設計：響應式設計，支援不同螢幕尺寸

## 注意事項

- 匯入的Excel檔案必須包含必要的欄位（路線編號、客運業者、平日班次、假日班次）
- 為獲得最佳效果，建議使用最新版本的網頁瀏覽器
- 大型Excel檔案可能需要較長的處理時間

---

© 2025 隨車問卷站牌抽樣數計算系統
